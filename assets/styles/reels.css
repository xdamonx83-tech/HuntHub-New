/* =========================================================
   HUNT.HUB — Reels (scoped)
   - Viewer (#reels-modal)
   - Composer (#reels-compose)
   - Comments (.hh-reels-comments)
   - Editor-Overlays des Composers (.hh-modal)
   Nur "body.hh-modal-open" bleibt global (Scroll lock).
   ========================================================= */

/* ---------- Global minimal ---------- */
body.hh-modal-open { overflow: hidden; }

/* ---------- Viewer (Full-Screen) ---------- */
#reels-modal{
  position: fixed; inset: 0; z-index: 9999;
  background: #000; /* solide: Seite dahinter NICHT sichtbar */
  display: grid; grid-template-rows: auto 1fr auto;
}
#reels-modal .reels-close{
  position: absolute; top: 16px; right: 16px; z-index: 2;
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(255,255,255,.15);
  color:#fff; border-radius: 999px; width: 40px; height: 40px;
  display:flex; align-items:center; justify-content:center;
  cursor: pointer;
}
#reels-modal .reels-upload{
  position:absolute; top:16px; right:64px; z-index:2;
  width:40px; height:40px; border-radius:999px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.15);
  color:#fff; font-size:20px; line-height:1; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
}
#reels-modal .reels-stack{ position: relative; width: 100vw; height: 100vh; }
#reels-modal .reels-loader{ position:absolute; inset:auto 0 32px 0; margin:auto; text-align:center; color:#aaa; }

/* Eine Reel-Seite */
#reels-modal .reel-frame{
  position:absolute; inset:0; display:grid; place-items:center;
}

/* Video füllt den Screen (wie TikTok) */
#reels-modal .reel-frame video{
  width: 100vw; height: 100vh;
  object-fit: cover; object-position:center;
  background:#000; outline: none;
}

/* Overlays */
#reels-modal .reel-overlay{
  position:absolute; left:16px; right:96px; bottom:20px; color:#fff;
  text-shadow: 0 1px 2px rgba(0,0,0,.6);
  pointer-events:none;
}
#reels-modal .reel-meta .reel-user{ display:flex; align-items:center; gap:8px; margin-bottom:6px; opacity:.95; }
#reels-modal .reel-avatar{ width:32px; height:32px; border-radius:999px; object-fit:cover; }

/* Caption / Hashtags + "Mehr lesen" */
#reels-modal .reel-desc{ font-size:16px; line-height:1.3; }
#reels-modal .reel-hashtags a{ color:#93c5fd; text-decoration:none; margin-right:6px; }

#reels-modal .reel-desc,
#reels-modal .reel-hashtags{
  position:relative;
  max-width:min(48vw, 820px);
  display:-webkit-box;
  -webkit-box-orient:vertical;
  -webkit-line-clamp:3;   /* Desktop */
  overflow:hidden;
  line-height:1.35;
  margin-top:6px;
}
@media (max-width: 768px){
  #reels-modal .reel-desc,
  #reels-modal .reel-hashtags{ -webkit-line-clamp:2; }
}
#reels-modal .reel-desc.moreable::after,
#reels-modal .reel-hashtags.moreable::after{
  content:"";
  position:absolute; left:0; right:0; bottom:0;
  height:2.2em;
  background:linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,.55));
  pointer-events:none;
}
#reels-modal .reel-desc.expanded,
#reels-modal .reel-hashtags.expanded{
  -webkit-line-clamp:unset;
  overflow:visible;
}
#reels-modal .reel-more{
  margin-top:6px;
  background:transparent; border:0;
  color:#e5e7eb; text-decoration:underline;
  font-size:14px; cursor:pointer; padding:0;
}

/* Side actions (rechts) */
#reels-modal .reel-actions{
  position:absolute; right:14px; bottom:18%;
  display:flex; flex-direction:column; gap:14px;
  pointer-events:auto;
}
#reels-modal .reel-icon{
  appearance:none; border:0; background:rgba(0,0,0,.25);
  color:#fff; padding:8px 10px; border-radius:12px;
  display:flex; align-items:center; gap:8px; cursor:pointer;
  backdrop-filter: blur(2px);
}
#reels-modal .reel-icon.is-liked{ color:#ef4444; }
#reels-modal .reel-icon .cnt, #reels-modal .reel-icon .ccnt{ min-width:1.5ch; text-align:right; }
#reels-modal .reel-icon .ccnt.bump{ animation: hh-bump .25s ease; }
@keyframes hh-bump { 0%{transform:scale(1)} 50%{transform:scale(1.25)} 100%{transform:scale(1)} }

/* Herz-Effekt */
#reels-modal .reel-like-fx{ position:absolute; inset:0; pointer-events:none; }
#reels-modal .fx-heart{
  position:absolute; bottom:18%; left:50%; transform:translateX(-50%);
  font-size:22px; opacity:0; filter: drop-shadow(0 2px 2px rgba(0,0,0,.25));
  animation: hh-float-heart 1.2s ease-out forwards;
}
@keyframes hh-float-heart{
  0%{ transform:translate(-50%,0) scale(1); opacity:0; }
  10%{ transform:translate(calc(-50% + var(--dx,0px)),-10px) scale(1.05); opacity:.95; }
  50%{ transform:translate(calc(-50% + var(--dx,0px)),-120px) scale(1.3); opacity:.95; }
  100%{ transform:translate(calc(-50% + var(--dx,0px)),-220px) scale(1.6); opacity:0; }
}

/* ---------- Gemeinsame Buttons/Inputs (nur in Reels-UIs) ---------- */
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-btn{
  border-radius: 10px; padding: 10px 14px; font-weight: 600; cursor: pointer;
}
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-btn-ghost{
  background: rgba(255,255,255,.06); color:#EDEDED;
}
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-btn-ghost:hover{
  background: rgba(255,255,255,.12);
}
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-btn-primary{
  background: linear-gradient(180deg,#e9e9e9,#bdbdbd);
  color:#111;
  box-shadow: 0 6px 18px rgba(255,255,255,.07) inset, 0 6px 18px rgba(0,0,0,.35);
}

:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-btn-danger{
  background:#b91c1c; color:#fff;
}
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-btn.is-disabled,
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-btn[disabled]{
  opacity:.5; cursor:not-allowed;
}

:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-input,
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-select,
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-textarea{
  width:100%; border-radius:10px; background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10); color:#EDEDED; padding:10px 12px;
}
:where(#reels-modal, #reels-compose, .hh-reels-comments) .reel-textarea{ min-height:70px; resize:vertical; }

/* ---------- Composer (großes Modal) ---------- */
#reels-compose{
  position: fixed; inset: 0; z-index: 100000;
  display:flex; align-items:center; justify-content:center;
  padding:0px; background: rgba(0,0,0,.65);
  -webkit-backdrop-filter: blur(3px); backdrop-filter: blur(3px);
}
#reels-compose .panel-xl{
  width:min(100%, 900px);
  background: linear-gradient(180deg, rgba(28,28,30,.92), rgba(18,18,20,.92));
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 20px; overflow: hidden;
  box-shadow: 0 25px 90px rgba(0,0,0,.7);
  color: #ECECEC;
  max-height: 92vh; overflow:auto;
}
.modal-bd { max-height: 95%; }
#reels-compose .modal-hd{
  display:flex; align-items:center; justify-content:space-between;
  padding: 14px 18px; border-bottom: 1px solid rgba(255,255,255,.08);
}
#reels-compose .modal-bd{ padding: 16px; }
#reels-compose .modal-ft{
  display:flex; gap:10px; justify-content:flex-end;
  padding: 14px 16px; border-top: 1px solid rgba(255,255,255,.08);
}

/* Composer Layout */
#reels-compose .reels-wrap{ display:grid; grid-template-columns: 1fr 360px; gap:20px; }
@media (max-width: 1024px){ #reels-compose .reels-wrap{ grid-template-columns: 1fr; } }

#reels-compose .reel-card{
  background: linear-gradient(180deg, rgba(28,28,30,.92), rgba(18,18,20,.92));
  border:1px solid rgba(255,255,255,.08); border-radius:16px; color:#ECECEC;
  box-shadow: 0 20px 60px rgba(0,0,0,.35);
}
#reels-compose .reel-card .hd{ padding:14px 16px; border-bottom:1px solid rgba(255,255,255,.08); font-weight: 600; }
#reels-compose .reel-card .bd{ padding:16px; }

#reels-compose .reel-row{ display:flex; gap:14px; flex-wrap: wrap; align-items:center; }
#reels-compose .reel-label{ font-size:12px; opacity:.7; }
#reels-compose .reel-hint{ font-size:12px; opacity:.7; margin-top:6px; }

#reels-compose .reel-cover{ display:flex; gap:12px; align-items:center; }
#reels-compose .reel-cover img{
  width:120px; height:160px; object-fit:cover; border-radius:12px; border:1px solid rgba(255,255,255,.12);
}

/* Rechts: Live-Preview */
#reels-compose .reel-side{ position:sticky; top:16px; }
#reels-compose .reel-side .preview{
  background:#000; border-radius:12px; overflow:hidden; border:1px solid rgba(255,255,255,.08);
}
#reels-compose .reel-side video{
  width:100%; height:auto; max-height:420px; object-fit: contain; background:#000;
}

/* Upload-Status */
#reels-compose .reel-upload-status{
  display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:10px; background:rgba(0,0,0,.35);
}
#reels-compose .reel-ok{ color:#22c55e; font-weight:700; }
#reels-compose .reel-meta{ font-size:12px; opacity:.85; }

/* Fortschritt (bar + label) */
#reels-compose .reel-progress{ margin-top:8px; height:6px; border-radius:999px; background:rgba(255,255,255,.12); overflow:hidden; }
#reels-compose .reel-progress-bar{
  height:100%; width:0%;
  background: linear-gradient(90deg, #4ade80, #22d3ee, #4ade80);
  background-size: 200% 100%;
  animation: hh-prog-stripes 1s linear infinite;
  transition: width .12s linear; border-radius: inherit;
}
#reels-compose .reel-progress-label{ margin-top:4px; font-size:12px; opacity:.8; }
@keyframes hh-prog-stripes { 0%{background-position:0% 0} 100%{background-position:200% 0} }

/* Button-Progress (kleine Leiste am unteren Rand des Publish-Buttons) */
#reels-compose .reel-btn.reel-btn-primary.is-uploading{ position:relative; }
#reels-compose .reel-btn.reel-btn-primary.is-uploading::after{
  content:""; position:absolute; left:0; bottom:0; height:2px;
  width: var(--btnp, 0%); background: currentColor; transition: width .1s linear;
}

/* ---------- Kleine Editor-Overlays des Composers ---------- */
/* Diese werden als <div class="hh-modal"><div class="panel-xl">…</div></div> angelegt */
.hh-modal{
  position:fixed; inset:0; z-index:100000; background:rgba(0,0,0,.65);
  display:flex; align-items:center; justify-content:center; padding:16px;
  -webkit-backdrop-filter: blur(3px); backdrop-filter: blur(3px);
}
.hh-modal .panel-xl{
  width:min(1200px, 100%); background:#111; color:#eee;
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px; overflow:hidden; box-shadow:0 25px 90px rgba(0,0,0,.7);
  max-height: 90vh; overflow:auto;
}
.hh-modal .modal-hd{
  padding:14px 16px; border-bottom:1px solid rgba(255,255,255,.08);
  font-weight:600; display:flex; justify-content:space-between;
}
.hh-modal .modal-bd{ padding:16px; }
.hh-modal .modal-ft{
  padding:14px 16px; border-top:1px solid rgba(255,255,255,.08);
  display:flex; justify-content:flex-end; gap:10px;
}

/* Video-/Cover-Editor Inhalte */
.hh-modal .editor-top{ width:100%; }
.hh-modal .editor-top video{
  width:100%; height:auto; max-height:62vh;
  object-fit:contain; background:#000; border-radius:12px;
}
.hh-modal .timeline{ margin-top:12px; }
.hh-modal .tn-strip{
  display:flex; gap:2px; overflow:hidden; background:#1a1a1a;
  border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:6px;
}
.hh-modal .tn-strip canvas{
  height:64px; width:calc((100% - 22px)/10); background:#000; border-radius:4px;
}
.hh-modal .range-wrap{ position:relative; margin-top:10px; }
.hh-modal .range-wrap input[type="range"]{
  width:100%; appearance:none; height:4px; background:#333; border-radius:999px; outline:none;
}
.hh-modal .range-wrap input[type="range"]::-webkit-slider-thumb{
  appearance:none; width:16px; height:16px; border-radius:50%; background:#fafafa; border:1px solid #999;
}
.hh-modal .range-dual{ display:grid; gap:6px; }
.hh-modal .range-values{ display:flex; justify-content:space-between; font-size:12px; opacity:.8; }

/* ---------- Comments Modal ---------- */
.hh-reels-comments{
  position: fixed; inset: 0; z-index: 100000;
  display:flex; align-items:center; justify-content:center;
  padding:16px; background: rgba(0,0,0,.65);
  -webkit-backdrop-filter: blur(3px); backdrop-filter: blur(3px);
}
.hh-reels-comments .panel-xl{
  width:min(100%, 860px);
  background:#111; color:#eee;
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px; overflow:hidden; box-shadow:0 25px 90px rgba(0,0,0,.7);
  max-height: 90vh; overflow:auto;
}
.hh-reels-comments .modal-hd{
  padding:14px 16px; border-bottom:1px solid rgba(255,255,255,.08);
  font-weight:600; display:flex; justify-content:space-between;
}
.hh-reels-comments .modal-bd{ padding:16px; }
.hh-reels-comments .modal-ft{
  padding:14px 16px; border-top:1px solid rgba(255,255,255,.08);
  display:flex; justify-content:flex-end; gap:10px;
}

/* ---------- (Optional) früheres Root/IFRAME – bleibt safe gescoped ---------- */
#reels-root{ position: fixed; inset: 0; z-index: 9000; touch-action: pan-y; }
#reels-iframe-modal{ position: fixed; inset: 0; z-index: 9999; }
#reels-iframe-modal .hh-reels-overlay{ position: absolute; inset: 0; background: #000; }
#reels-iframe-modal .hh-reels-frame{ position: absolute; inset: 0; display: grid; }
#reels-iframe-modal iframe{ width: 100%; height: 100%; border: 0; display: block; background: #000; }
#reels-iframe-modal .hh-reels-close{
  position: absolute; top: 16px; right: 16px; z-index: 2;
  width: 40px; height: 40px; border-radius: 999px;
  border: 1px solid rgba(255,255,255,.15);
  background: rgba(255,255,255,.08); color: #fff; cursor: pointer;
}
/* Modal muss Touch-Pan blockieren */
#reels-modal{
  position: fixed; inset: 0; z-index: 9999;
  background: #000;
  touch-action: none;                 /* <-- wichtig */
  overscroll-behavior: contain;       /* verhindert Rubberbanding */
}

/* Wenn ein Reels-Modal offen ist, Body wirklich stilllegen */
html.hh-lock, body.hh-lock {          /* Klasse setzen wir in JS, siehe unten */
  overflow: hidden !important;
  height: 100% !important;
}
/* Overlay bleibt klick-durchlässig … */
#reels-modal .reel-overlay { pointer-events: none; }
/* … aber Text/Buttons darin müssen wieder klickbar sein */
#reels-modal .reel-meta,
#reels-modal .reel-more { pointer-events: auto; }
/* Sound-Button benutzt deine .reel-icon Styles */
.reel-icon.sound .ico.muted   { display:none; }
.reel-icon.sound.is-off .ico.muted { display:inline; }
.reel-icon.sound.is-off .ico.unmuted { display:none; }

/* kleiner Hinweis, wenn Autoplay mit Ton blockiert wurde */
.reel-sound-hint{
  position:absolute; left:50%; transform:translateX(-50%);
  bottom:86px; padding:6px 10px; border-radius:10px;
  background:rgba(0,0,0,.45); color:#fff; font-size:13px;
  border:1px solid rgba(255,255,255,.15);
  pointer-events:none;
}
/* ===== Reels Composer: Mobile Fullscreen ===== */
#reels-compose[data-fullscreen="1"]{
  position: fixed;
  inset: 0;
  z-index: 100000; /* über Viewer/Comments */
  width: 100%;
  /* robuste Höhe: moderne Browser → 100dvh/100svh; Fallback über --vh (JS) */
  height: 100dvh;
  height: 100svh;
  height: calc(var(--vh, 1vh) * 100);
  display: flex;
  flex-direction: column;
  background: #0a0a0a;
  color: #e5e5e5;
  overscroll-behavior-y: contain;
}

body.hh-lock, body.hh-modal-open{
  overflow: hidden;
  touch-action: none;
}

/* Header & Footer (sticky, mit Safe-Area) */
#reels-compose[data-fullscreen="1"] .rc-header,
#reels-compose[data-fullscreen="1"] [data-role="header"]{
  position: sticky; top: 0;
  padding: calc(env(safe-area-inset-top) + 8px) 12px 8px 12px;
  background: linear-gradient(180deg, rgba(20,20,20,.96), rgba(10,10,10,.9));
  backdrop-filter: blur(6px);
  display: flex; align-items: center; gap: 8px;
  min-height: 44px;
  z-index: 2;
  border-bottom: 1px solid rgba(255,255,255,.06);
}

#reels-compose[data-fullscreen="1"] .rc-footer,
#reels-compose[data-fullscreen="1"] [data-role="footer"]{
  position: sticky; bottom: 0;
  padding: 8px 12px calc(env(safe-area-inset-bottom) + 10px) 12px;
  background: linear-gradient(0deg, rgba(20,20,20,.96), rgba(10,10,10,.9));
  backdrop-filter: blur(6px);
  z-index: 2;
  border-top: 1px solid rgba(255,255,255,.06);
}

/* Scrollbarer Content */
#reels-compose[data-fullscreen="1"] .rc-content,
#reels-compose[data-fullscreen="1"] [data-role="content"]{
  flex: 1 1 auto;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 10px 12px 12px 12px;
}

/* Videobühne mit 9:16-Frame */
#reels-compose[data-fullscreen="1"] .rc-video-stage,
#reels-compose[data-fullscreen="1"] [data-role="video-stage"]{
  position: relative;
  width: 100%;
  max-width: 480px;
  margin: 0 auto;
  aspect-ratio: 9 / 16;
  background: #111;
  border-radius: 12px;
  overflow: hidden;
}
#reels-compose[data-fullscreen="1"] .rc-video-stage video,
#reels-compose[data-fullscreen="1"] [data-role="video-stage"] video{
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: contain; /* nimm 'cover' wenn du füllen willst */
}

/* Trimmer: größere Touch-Ziele */
#reels-compose[data-fullscreen="1"] .rc-trimmer,
#reels-compose[data-fullscreen="1"] [data-role="trimmer"]{
  margin: 12px auto 6px auto;
  width: min(680px, 100%);
}
#reels-compose[data-fullscreen="1"] .rc-trimmer .handle{
  width: 22px; height: 48px; border-radius: 8px;
}

/* Controls unten: Buttons nebeneinander */
#reels-compose[data-fullscreen="1"] .rc-actions,
#reels-compose[data-fullscreen="1"] [data-role="actions"]{
  display: flex; gap: 8px; align-items: center; justify-content: space-between;
}
#reels-compose[data-fullscreen="1"] .reel-btn-primary{
  appearance: none; border: 0; border-radius: 12px;
  padding: 12px 16px; font-weight: 600;
  background: linear-gradient(180deg,#e9e9e9,#bdbdbd);
  color: #111;
  box-shadow: 0 6px 18px rgba(255,255,255,.07) inset, 0 6px 18px rgba(0,0,0,.35);
}
#reels-compose[data-fullscreen="1"] .reel-btn-ghost{
  appearance: none; border: 1px solid rgba(255,255,255,.15);
  background: rgba(255,255,255,.04);
  color: #e5e5e5; padding: 12px 16px; border-radius: 12px;
}

/* Desktop bleibt „Dialog“ mittig */
@media (min-width: 769px){
  #reels-compose[data-fullscreen="1"]{
    width: min(980px, 92vw);
    height: min(92vh, 860px);
    left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    border-radius: 16px;
  }
}
/* ==== Reels Composer: echtes Fullscreen auf Mobile ==== */
body.hh-lock { overflow: hidden; touch-action: none; }

#reels-compose[data-fullscreen="1"]{
  position: fixed;
  inset: 0;
  z-index: 100000;
  width: 100%;
  /* robuste Höhen – moderne Browser + Fallback */
  height: 100dvh;
  height: 100svh;
  height: calc(var(--vh, 1vh) * 100);
  display: flex;
  flex-direction: column;
  background: #0a0a0a; /* dein Dark-Theme */
  color: #e5e5e5;
  overscroll-behavior-y: contain;
}

/* Panel soll die volle Höhe einnehmen */
#reels-compose[data-fullscreen="1"] .panel-xl{
  position: static;
  inset: auto;
  width: 100%;
  height: 100%;
  max-width: none;
  max-height: none;
  border-radius: 0;
  display: flex;
  flex-direction: column;
}

/* Sticky Header/Footer mit Safe-Areas */
#reels-compose[data-fullscreen="1"] .modal-hd{
  position: sticky; top: 0;
  padding: calc(env(safe-area-inset-top) + 8px) 12px 8px;
  background: linear-gradient(180deg, rgba(20,20,20,.96), rgba(10,10,10,.9));
  backdrop-filter: blur(6px);
  border-bottom: 1px solid rgba(255,255,255,.06);
  z-index: 2;
}
#reels-compose[data-fullscreen="1"] .modal-ft{
  position: sticky; bottom: 0;
  padding: 8px 12px calc(env(safe-area-inset-bottom) + 10px) 12px;
  background: linear-gradient(0deg, rgba(20,20,20,.96), rgba(10,10,10,.9));
  backdrop-filter: blur(6px);
  border-top: 1px solid rgba(255,255,255,.06);
  z-index: 2;
}

/* Scrollbarer Mittelbereich */
#reels-compose[data-fullscreen="1"] .modal-bd{
  flex: 1 1 auto;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 10px 12px 12px;
}

/* Mobile Layout: Spalten stapeln */
@media (max-width: 768px){
  #reels-compose .reels-wrap{ display:block; }
  #reels-compose .reel-side{ margin-top: 12px; }
  #reels-compose video[data-preview]{
    width: 100%;
    height: auto;
    max-height: 60vh;
    object-fit: contain;
  }
}
